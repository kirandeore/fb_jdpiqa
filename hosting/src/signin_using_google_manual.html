<html>
    <!-- host this file on a webserver to run correctly -->
    
    <!-- **********************************************
     * TODO(DEVELOPER): Use your Client ID below. *
     ********************************************** -->
    <meta name="google-signin-client_id" content="961745701287-9ptlt40c0uqko1apl5v9elfkvbis9e0r.apps.googleusercontent.com">
    <meta name="google-signin-cookiepolicy" content="single_host_origin">
    <meta name="google-signin-scope" content="profile email">
    
      
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    
    <!-- <script src="https://www.gstatic.com/firebasejs/5.5.3/firebase.js"></script> -->
  <script>
  //   const defaultApp = firebase.initializeApp({
  //   apiKey: "AIzaSyAjzNDi4fBMjpUwxBsj_oEcsRsZNcsjF2U",
  //   authDomain: "jdpiqa.firebaseapp.com",
  //   databaseURL: "https://jdpiqa.firebaseio.com",
  //   projectId: "jdpiqa",
  //   storageBucket: "jdpiqa.appspot.com",
  //   messagingSenderId: "961745701287"
  // })

    function onSignIn(googleUser) {
      console.log('Google Auth Response', googleUser);
      console.log('email', googleUser.getBasicProfile().getEmail(), googleUser.getAuthResponse().id_token)
      
      fetch('http://localhost:8050/signin', {
        method: "POST", // *GET, POST, PUT, DELETE, etc.
        mode: "no-cors", // no-cors, cors, *same-origin
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ token: googleUser.getAuthResponse().id_token }), // body data type must match "Content-Type" header
    })
    .then(response => response); // parses response to JSON

      // We need to register an Observer on Firebase Auth to make sure auth is initialized.
      // var unsubscribe = firebase.auth().onAuthStateChanged(function(firebaseUser) {
      //   unsubscribe();
      //   // Check if we are already signed-in Firebase with the correct user.
      //   if (!isUserEqual(googleUser, firebaseUser)) {
      //     // Build Firebase credential with the Google ID token.
      //     var credential = firebase.auth.GoogleAuthProvider.credential(
      //         googleUser.getAuthResponse().id_token);
      //     // Sign in with credential from the Google user.
      //     firebase.auth().signInAndRetrieveDataWithCredential(credential).catch(function(error) {
      //       // Handle Errors here.
      //       var errorCode = error.code;
      //       var errorMessage = error.message;
      //       // The email of the user's account used.
      //       var email = error.email;
      //       // The firebase.auth.AuthCredential type that was used.
      //       var credential = error.credential;
      //       // ...
      //     });
      //   } else {
      //     console.log('User already signed-in Firebase.');
      //   }
      // });
    }



  </script>
  <body>
      <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>
  </body>
</html>
